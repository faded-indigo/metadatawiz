<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>{{APP_NAME}} - Help (v{{APP_VERSION}})</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --bg:#0b1220;
      --panel:#121b2e;
      --soft:#0f1626;
      --fg:#e6edf6;
      --muted:#a7b1c2;
      --accent:#5fb3d9;
      --border:#1f2a44;
    }
    html,body{
      margin:0;
      padding:0;
      background:var(--bg);
      color:var(--fg);
      font:16px/1.6 system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;
    }
    main{max-width:940px;margin:2rem auto;padding:0 1rem 3rem;}
    h1{font-size:1.9rem;margin:.2rem 0 1rem;}
    h2{font-size:1.3rem;margin:1.5rem 0 .55rem;border-bottom:1px solid var(--border);padding-bottom:.35rem;}
    h3{font-size:1.05rem;margin:1rem 0 .4rem;}
    p{margin:.3rem 0 .9rem;}
    ul,ol{margin:.3rem 0 .9rem 1.2rem;}
    li{margin:.25rem 0;}
    .panel{background:var(--panel);border:1px solid var(--border);border-radius:.45rem;padding:.9rem 1rem;margin:.8rem 0 1rem;}
    .muted{color:var(--muted);}
    code,kbd{
      font-family:ui-monospace,SFMono-Regular,Consolas,monospace;
      background:var(--soft);
      border-radius:.25rem;
      padding:.08rem .32rem;
    }
    table{width:100%;border-collapse:collapse;margin:.5rem 0 1rem;}
    th,td{border:1px solid var(--border);padding:.45rem .5rem;vertical-align:top;text-align:left;}
    th{background:var(--panel);}
    a{color:var(--accent);}
  </style>
</head>
<body>
<main>
  <h1>{{APP_NAME}} <span class="muted">v{{APP_VERSION}}</span></h1>
  <p class="panel">
    Windows tool for scanning PDF folders and batch-editing metadata safely via ExifTool.
    Writes are explicit, undoable, and designed for predictable archival workflows.
  </p>

  <h2>Quick Workflow</h2>
  <ol>
    <li>Select source folder, then load/scan.</li>
    <li>Check files you want to modify in the table.</li>
    <li>Edit values in the Metadata panel.</li>
    <li>Use field buttons (`Update`, `Add`, `Clear`) to write.</li>
    <li>Use `Undo last` if needed.</li>
  </ol>

  <h2>Selection And Preview (v0.8)</h2>
  <ul>
    <li>Only <strong>checked rows</strong> are actionable for writes.</li>
    <li>Clicked row is <strong>preview only</strong> when nothing is checked.</li>
    <li>Table highlighting alone never triggers writes.</li>
    <li>Panel refreshes immediately when checked rows or clicked row change.</li>
  </ul>

  <h2>Editing Surface</h2>
  <ul>
    <li>The table is read-only.</li>
    <li>The Metadata panel is the only editing surface.</li>
    <li>All writes originate from panel buttons.</li>
  </ul>

  <h2>Multi-Select Display</h2>
  <ul>
    <li>Single checked file: panel shows exact values.</li>
    <li>Multiple checked files:
      <ul>
        <li>If a field value matches across all checked files, that value is shown.</li>
        <li>If values differ, input text is empty and placeholder is <code>(Multiple values)</code>.</li>
      </ul>
    </li>
    <li>The placeholder text is informational only and is never written to PDFs.</li>
  </ul>

  <h2>Field Actions</h2>
  <table>
    <thead>
      <tr><th>Field</th><th>Buttons</th><th>Behavior</th></tr>
    </thead>
    <tbody>
      <tr>
        <td>Title</td>
        <td>Update, Clear, Copy filename -&gt; Title</td>
        <td>Update replaces Title. Clear removes Title (confirmation). Copy filename sets Title from each file stem.</td>
      </tr>
      <tr>
        <td>Author</td>
        <td>Update, Add, Clear</td>
        <td>Update replaces. Add merges tokens split on <code>, ; |</code> with case-insensitive de-dup.</td>
      </tr>
      <tr>
        <td>Subject</td>
        <td>Update, Add, Clear</td>
        <td>Update replaces. Add merges tokens split on <code>, ; |</code> with case-insensitive de-dup.</td>
      </tr>
      <tr>
        <td>Keywords</td>
        <td>Update, Add, Clear, Sort, Add shib-[foldername], Add shib-1234</td>
        <td>Keywords are canonicalized (normalize, split/trim, de-dup, natural sort, <code>shib-*</code> ordering, delimiter <code>", "</code>).</td>
      </tr>
    </tbody>
  </table>

  <h2>Confirmation And Empty-Input Rules</h2>
  <ul>
    <li><code>Update</code> and <code>Add</code> ignore empty input silently.</li>
    <li><code>Clear</code> always requires explicit confirmation.</li>
    <li>Multi-file confirmations support "Don't ask again" per action and per field.</li>
  </ul>

  <h2>Protected Or Corrupted PDFs</h2>
  <ul>
    <li>Preview may still show available metadata, but panel indicates non-modifiable state.</li>
    <li>If any checked file is protected/corrupted, relevant action buttons are disabled.</li>
    <li>Uncheck blocked files before writing.</li>
  </ul>

  <h2>After Writes And Undo</h2>
  <ul>
    <li>After update/add/clear/undo, table rows are re-read from disk.</li>
    <li>Panel values are re-populated from current selection state.</li>
    <li>ExifTool remains the only read/write mechanism.</li>
  </ul>

  <h2>Folder Access</h2>
  <ul>
    <li><code>Open pdf source folder</code> in Source panel opens the loaded source directory.</li>
    <li>Metadata panel has a second, prominent <code>Open folder</code> button with rename guidance.</li>
    <li>Rename operations are intentionally outside metadata write actions.</li>
  </ul>

  <h2>Troubleshooting</h2>
  <ul>
    <li><strong>Write disabled:</strong> ensure at least one row is checked and no blocked files are checked.</li>
    <li><strong>No visible change:</strong> check Errors dialog, then verify file permissions/locks.</li>
    <li><strong>Need rollback:</strong> use <code>Undo last</code>.</li>
  </ul>
</main>
</body>
</html>
